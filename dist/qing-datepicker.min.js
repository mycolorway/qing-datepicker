/* qing-datepicker v1.0.1 | (c) Mycolorway Design | MIT License */
!function(t,e){"object"==typeof module&&module.exports?module.exports=e(require("jquery"),require("moment"),require("qing-module")):t.QingDatepicker=e(t.jQuery,t.moment,t.QingModule)}(this,function(t,e,r){var i=require=function t(e,r,i){function n(s,p){if(!r[s]){if(!e[s]){var a="function"==typeof require&&require;if(!p&&a)return a(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=r[s]={exports:{}};e[s][0].call(u.exports,function(t){var r=e[s][1][t];return n(r?r:t)},u,u.exports,t,e,r,i)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)n(i[s]);return n}({1:[function(e,i,n){var o,s=function(t,e){function r(){this.constructor=t}for(var i in e)p.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},p={}.hasOwnProperty;o=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return s(r,e),r.opts={wrapper:null,placeholder:""},r.prototype._setOptions=function(e){return r.__super__._setOptions.apply(this,arguments),t.extend(this.opts,r.opts,e)},r.prototype._init=function(){return this.wrapper=t(this.opts.wrapper),this.active=!1,this.empty=!0,this._render(),this._bind()},r.prototype._render=function(){return this.el=t('<div class="input empty">'),this.textField=t('<input type="text" class="text-field" readonly>').attr("placeholder",this.opts.placeholder).appendTo(this.el),this.linkClear=t('<a class="link-clear" href="javascript:;" tabindex="-1">\n  &#10005;\n</a>').appendTo(this.el),this.el.appendTo(this.wrapper)},r.prototype._bind=function(){return this.textField.on("click",function(t){return function(e){if(!t.disabled)return t.trigger("click")}}(this)),this.textField.on("input",function(t){return function(e){return t._inputTimer&&(clearTimeout(t._inputTimer),t._inputTimer=null),t._inputTimer=setTimeout(function(){return t.trigger("change",[t.textField.val()])},400)}}(this)),this.textField.on("keydown",function(t){return function(e){var r;if(!t.disabled)return 13===(r=e.which)||38===r||40===r?t.trigger("click"):void 0}}(this)),this.linkClear.on("click",function(t){return function(e){return t.trigger("clearClick"),!1}}(this))},r.prototype.setValue=function(t){return this.textField.val(t),this.setEmpty(!t),t},r.prototype.getValue=function(){return this.textField.val()},r.prototype.setActive=function(t){return this.active=t,this.textField.toggleClass("active",t),this.active},r.prototype.setEmpty=function(t){return this.empty=t,this.el.toggleClass("empty",t),this.empty},r.prototype.setDisabled=function(t){if(t!==this.disabled)return this.el.toggleClass("disabled",t),this.textField.prop("disabled",t),this.disabled=t},r.prototype.destroy=function(){return this.el.remove()},r}(r),i.exports=o},{}],2:[function(i,n,o){var s,p,a,c,u=function(t,e){function r(){this.constructor=t}for(var i in e)l.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},l={}.hasOwnProperty;s=i("./select-views/date-select.coffee"),p=i("./select-views/month-select.coffee"),c=i("./select-views/year-select.coffee"),a=function(r){function i(){return i.__super__.constructor.apply(this,arguments)}return u(i,r),i.opts={wrapper:null,appendTo:"body",locales:null},i.prototype._setOptions=function(e){return i.__super__._setOptions.apply(this,arguments),t.extend(this.opts,i.opts,e)},i.prototype._init=function(){return this.active=!1,this._render(),this.dateSelect=new s({wrapper:this.el}),this.monthSelect=new p({wrapper:this.el}),this.yearSelect=new c({wrapper:this.el,locales:this.opts.locales}),this._bind()},i.prototype._render=function(){return this.el=t('<div class="qing-datepicker-popover"></div>').appendTo(this.opts.appendTo)},i.prototype._bind=function(){return this.dateSelect.on("yearClick",function(t){return function(e,r){return t.yearSelect.setYear(r),t.setSelectView(t.yearSelect)}}(this)),this.dateSelect.on("monthClick",function(t){return function(e,r){return t.monthSelect.setMonth(r),t.setSelectView(t.monthSelect)}}(this)),this.dateSelect.on("select",function(t){return function(e,r){return t.date=r,t.trigger("select",[t.date.clone()])}}(this)),this.monthSelect.on("yearClick",function(t){return function(e,r){return t.yearSelect.setYear(r),t.setSelectView(t.yearSelect)}}(this)),this.monthSelect.on("select",function(t){return function(e,r){return t.date.set({year:r.year(),month:r.month()}),t.dateSelect.setMonth(r),t.setSelectView(t.dateSelect)}}(this)),this.yearSelect.on("select",function(t){return function(e,r){return t.monthSelect.setYear(r),t.date.year(r),t.setSelectView(t.monthSelect)}}(this))},i.prototype.setSelectView=function(t){if(t!==this.selectView)return this.selectView&&this.selectView.setActive(!1),t.setActive(!0),this.selectView=t,this.selectView},i.prototype.setDate=function(t){return null==t&&(t=new Date),this.date=e(t),this.dateSelect.setDate(this.date.clone()),this.setSelectView(this.dateSelect),this.date},i.prototype.setActive=function(t){return this.active=t,this.el.toggleClass("active",t),this.active?this.trigger("show"):this.trigger("hide"),this.active},i.prototype.setPosition=function(t){return this.el.css({top:t.top,left:t.left||0})},i.prototype.destroy=function(){return this.el.remove()},i}(r),n.exports=a},{"./select-views/date-select.coffee":3,"./select-views/month-select.coffee":4,"./select-views/year-select.coffee":6}],3:[function(r,i,n){var o,s,p=function(t,e){function r(){this.constructor=t}for(var i in e)a.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},a={}.hasOwnProperty;s=r("./select-view.coffee"),o=function(r){function i(){return i.__super__.constructor.apply(this,arguments)}return p(i,r),i.prototype._init=function(){return i.__super__._init.apply(this,arguments),this.date=e().startOf("day"),this.month=e().startOf("month")},i.prototype._render=function(){return i.__super__._render.apply(this,arguments),t('<a href="javascript:;" class="link-year"></a>\n<a href="javascript:;" class="link-month"></a>').appendTo(this.el.find(".title")),this.el.addClass("date-select")},i.prototype._renderGrid=function(){return this.el.find(".link-year").text(this.month.format("YYYY")),this.el.find(".link-month").text(this.month.format("MMM")),this.grid.empty(),this._renderGridHead(),this._renderGridBody(),this.grid},i.prototype._renderGridHead=function(){var r;return r=t('<div class="weekdays">'),t.each(e.weekdaysMin(!0),function(e){return function(e,i){return t("<span>",{class:"weekday",text:i}).appendTo(r)}}(this)),this.grid.prepend(r)},i.prototype._renderGridBody=function(){var r,i,n,o,s;for(r=t('<div class="days">'),n=this.month.clone().startOf("week"),o=this.month.clone().endOf("month").endOf("week");n.isSameOrBefore(o);)i=t("<a>",{href:"javascript:;",class:"grid-item link-day","data-date":n.format("YYYY-MM-DD"),text:n.format("D")}),n.clone().startOf("month").isSame(this.month)||i.addClass("minor"),n.isSame(this.date)&&i.addClass("selected"),n.isSame(e().startOf("day"))&&i.addClass("current"),s=["sun","mon","tue","wed","thu","fri","sat"],i.addClass(s[n.day()]).appendTo(r),n.add(1,"days");return this.grid.append(r),this.grid},i.prototype._bind=function(){return i.__super__._bind.apply(this,arguments),this.el.on("click",".link-prev",function(t){return function(e){return t.month.subtract(1,"months"),t._renderGrid()}}(this)),this.el.on("click",".link-next",function(t){return function(e){return t.month.add(1,"months"),t._renderGrid()}}(this)),this.el.on("click",".link-year",function(t){return function(e){return t.trigger("yearClick",[t.month.year()])}}(this)),this.el.on("click",".link-month",function(t){return function(e){return t.trigger("monthClick",[t.month.clone()])}}(this)),this.el.on("click",".link-day",function(r){return function(i){var n,o;return n=t(i.currentTarget),o=e(n.data("date")),r.trigger("select",[o])}}(this))},i.prototype.setDate=function(t){if(e.isMoment(t)&&t.isValid())return this.date=t,this.month=t.clone().startOf("month"),this._renderGrid(),this.date},i.prototype.setMonth=function(t){if(e.isMoment(t)&&t.isValid())return this.month=t,this._renderGrid(),this.month},i}(s),i.exports=o},{"./select-view.coffee":5}],4:[function(r,i,n){var o,s,p=function(t,e){function r(){this.constructor=t}for(var i in e)a.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},a={}.hasOwnProperty;s=r("./select-view.coffee"),o=function(r){function i(){return i.__super__.constructor.apply(this,arguments)}return p(i,r),i.prototype._init=function(){return i.__super__._init.apply(this,arguments),this.month=e().startOf("month"),this.year=e().year()},i.prototype._render=function(){return i.__super__._render.apply(this,arguments),t('<a href="javascript:;" class="link-year"></a>').appendTo(this.el.find(".title")),this.el.addClass("month-select")},i.prototype._renderGrid=function(){var r,i,n,o;for(this.el.find(".link-year").text(this.year),this.grid.empty(),o=e([this.year,0,1]),i=n=0;n<=11;i=++n)i>0&&(o=o.add(1,"months")),r=t("<a>",{href:"javascript:;",class:"grid-item link-month","data-month":o.format("YYYY-MM"),text:o.format("MMM")}),o.isSame(e().startOf("month"))&&r.addClass("current"),o.isSame(this.month)&&r.addClass("selected"),r.appendTo(this.grid);return this.grid},i.prototype._bind=function(){return i.__super__._bind.apply(this,arguments),this.el.on("click",".link-prev",function(t){return function(e){return t.year-=1,t._renderGrid()}}(this)),this.el.on("click",".link-next",function(t){return function(e){return t.year+=1,t._renderGrid()}}(this)),this.el.on("click",".link-year",function(t){return function(e){return t.trigger("yearClick",[t.year])}}(this)),this.el.on("click",".link-month",function(r){return function(i){var n,o;return n=t(i.currentTarget),o=e(n.data("month")),r.trigger("select",[o])}}(this))},i.prototype.setMonth=function(t){if(e.isMoment(t)&&t.isValid())return this.month=t,this.year=t.year(),this._renderGrid(),this.month},i.prototype.setYear=function(t){return this.year=t,this._renderGrid(),this.year},i}(s),i.exports=o},{"./select-view.coffee":5}],5:[function(e,i,n){var o,s=function(t,e){function r(){this.constructor=t}for(var i in e)p.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},p={}.hasOwnProperty;o=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return s(r,e),r.opts={wrapper:null},r.prototype._setOptions=function(e){return r.__super__._setOptions.apply(this,arguments),t.extend(this.opts,r.opts,e)},r.prototype._init=function(){return this.wrapper=t(this.opts.wrapper),this.active=!1,this._render(),this._bind()},r.prototype._render=function(){return this.el=t('<div class="select-view">\n  <div class="top-bar">\n    <a href="javascript:;" class="link-prev">&lt;</a>\n    <span class="title">\n    </span>\n    <a href="javascript:;" class="link-next">&gt;</a>\n  </div>\n  <div class="select-grid"></div>\n</div>').appendTo(this.wrapper),this.grid=this.el.find(".select-grid"),this.el},r.prototype._renderGrid=function(){},r.prototype._bind=function(){},r.prototype.setActive=function(t){return this.active=t,this.el.toggleClass("active",t),this.active},r}(r),i.exports=o},{}],6:[function(r,i,n){var o,s,p=function(t,e){function r(){this.constructor=t}for(var i in e)a.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},a={}.hasOwnProperty;o=r("./select-view.coffee"),s=function(r){function i(){return i.__super__.constructor.apply(this,arguments)}return p(i,r),i.opts={locales:null},i.prototype._setOptions=function(e){return i.__super__._setOptions.apply(this,arguments),t.extend(this.opts,i.opts,e)},i.prototype._init=function(){return i.__super__._init.apply(this,arguments),this.year=e().year(),this.currentYear=this.year},i.prototype._render=function(){return i.__super__._render.apply(this,arguments),this.el.find(".title").text(this.opts.locales.selectYear),this.el.addClass("year-select")},i.prototype._renderGrid=function(){var r,i,n,o,s,p,a;for(this.grid.empty(),p=this.year-4,i=this.year+4,a=n=o=p,s=i;o<=s?n<=s:n>=s;a=o<=s?++n:--n)r=t("<a>",{href:"javascript:;",class:"grid-item link-year","data-year":a,text:a}),a===e().year()&&r.addClass("current"),a===this.currentYear&&r.addClass("selected"),r.appendTo(this.grid);return this.grid},i.prototype._bind=function(){return i.__super__._bind.apply(this,arguments),this.el.on("click",".link-prev",function(t){return function(e){return t.year-=9,t._renderGrid()}}(this)),this.el.on("click",".link-next",function(t){return function(e){return t.year+=9,t._renderGrid()}}(this)),this.el.on("click",".link-year",function(e){return function(r){var i,n;return i=t(r.currentTarget),n=i.data("year"),e.trigger("select",[n])}}(this))},i.prototype.setYear=function(t){return this.year=t,this.currentYear=t,this._renderGrid(),this.year},i}(o),i.exports=s},{"./select-view.coffee":5}],"qing-datepicker":[function(i,n,o){var s,p,a,c=function(t,e){function r(){this.constructor=t}for(var i in e)u.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},u={}.hasOwnProperty;s=i("./input.coffee"),p=i("./popover.coffee"),a=function(r){function i(){return i.__super__.constructor.apply(this,arguments)}return c(i,r),i.name="QingDatepicker",i.opts={el:null,placeholder:"",format:"YYYY-MM-DD",displayFormat:"LL",inputFormats:["YYYY-M-D","M/D/YY","YYYY年M月D日","YYYY.M.D","YYYY/M/D"],renderer:null,popoverOffset:6,popoverAppendTo:"body",locales:{selectYear:"Select Year"}},i.count=0,i.prototype._setOptions=function(e){return i.__super__._setOptions.apply(this,arguments),t.extend(this.opts,i.opts,e)},i.prototype._init=function(){var r,n,o;if(this.el=t(this.opts.el),!(this.el.length>0))throw new Error("QingDatepicker: option el is required");return(n=this.el.data("qingDatepicker"))?n:(this.inputFormats=this.opts.inputFormats,this.locales=this.opts.locales||i.locales,this.id=++i.count,this._render(),this._initChildComponents(),this._bind(),t.isFunction(this.opts.renderer)&&this.opts.renderer.call(this,this.wrapper,this),(o=this.el.val())&&(r=e(o,this.opts.format)).isValid()&&(this.input.setValue(r.format(this.opts.displayFormat)),this.date=r),this.el.prop("disabled")?this.disable():void 0)},i.prototype._render=function(){return this.wrapper=t('<div class="qing-datepicker"></div>').data("qingDatepicker",this).insertBefore(this.el).append(this.el),this.el.hide().data("qingDatepicker",this)},i.prototype._initChildComponents=function(){return this.input=new s({wrapper:this.wrapper,placeholder:this.opts.placeholder||this.el.attr("placeholder")||""}),this.popover=new p({appendTo:this.opts.popoverAppendTo,locales:this.locales})},i.prototype._bind=function(){return t(document).on("click.qing-datepicker-"+this.id,function(e){return function(r){if(!t.contains(e.wrapper[0],r.target)&&!t.contains(e.popover.el[0],r.target))return e.popover.setActive(!1),null}}(this)),this.input.on("click",function(t){return function(){return t.popover.active?(t.popover.setActive(!1),t.input.setActive(!1)):(t.popover.setDate(t.date),t.popover.setActive(!0),t.input.setActive(!0))}}(this)),this.input.on("clearClick",function(t){return function(){return t.setValue(""),t.popover.setActive(!1),t.input.setActive(!1)}}(this)),this.input.on("change",function(t){return function(r,i){var n;if(n=e(i,t.inputFormats,!0),n.isValid())return t.setDate(n),t.popover.setDate(t.date)}}(this)),this.popover.on("show",function(t){return function(e){return t.positionPopover()}}(this)),this.popover.on("select",function(t){return function(e,r){return t.setDate(r),t.popover.setActive(!1),t.input.setActive(!1)}}(this)),this.on("change",function(t){return function(e){return t.el.trigger("change",[t.date])}}(this))},i.prototype.positionPopover=function(){var e,r,i,n,o,s,p,a;return r=this.input.el.offset(),e=this.input.el.outerHeight(),i=r.top-t(window).scrollTop(),a=this.popover.el.offsetParent().offset(),p=this.popover.el.outerHeight(),o=r.top-a.top,n=r.left-a.left,s=i+e+p>t(window).height()?{top:r.top-p-this.opts.popoverOffset,left:n}:{top:o+e+this.opts.popoverOffset,left:n},this.popover.setPosition(s)},i.prototype.setDate=function(t){return e.isMoment(t)&&t.isValid()&&!t.isSame(this.date)&&(this.input.setValue(t.format(this.opts.displayFormat)),this.el.val(t.format(this.opts.format)),this.date=t,this.trigger("change",[this.date.clone()])),this},i.prototype.getDate=function(){return this.date},i.prototype.setValue=function(t){var r;return t?(r=e(t,this.opts.format),this.setDate(r)):(this.input.setValue(""),this.el.val(""),this.date=null,this.trigger("change",[this.date])),this},i.prototype.getValue=function(){return this.el.val()},i.prototype.disable=function(){return this.el.prop("disabled",!0),this.input.setDisabled(!0)},i.prototype.enable=function(){return this.el.prop("disabled",!1),this.input.setDisabled(!1)},i.prototype.destroy=function(){return this.popover.destroy(),this.el.insertAfter(this.wrapper).show().removeData("qingDatepicker"),this.wrapper.remove(),t(document).off(".qing-datepicker-"+this.id)},i}(r),n.exports=a},{"./input.coffee":1,"./popover.coffee":2}]},{},[]);return i("qing-datepicker")});